generator client {
    provider = "prisma-client-js"
}

datasource db {
    provider = "mongodb"
    url      = env("DATABASE_URL")
}

model User {
    id         String      @id @default(auto()) @map("_id") @db.ObjectId
    email      String      @unique
    password   String
    name       String?
    UserClaims UserClaim[]
    UserRoles  UserRole[]
}

model Role {
    id         String      @id @default(auto()) @map("_id") @db.ObjectId
    name       String      @unique
    RoleClaims RoleClaim[]
    UserRoles  UserRole[]
}

model UserRole {
    id     String @id @default(auto()) @map("_id") @db.ObjectId
    userId String @db.ObjectId
    user   User?   @relation(fields: [userId], references: [id])
    roleId String @db.ObjectId
    role   Role?   @relation(fields: [roleId], references: [id])
    @@unique([userId, roleId], name: "user_role_identifier")
}

model RoleClaim {
    id        String  @id @default(auto()) @map("_id") @db.ObjectId
    roleId    String  @db.ObjectId
    role      Role    @relation(fields: [roleId], references: [id])
    claimType String
    value     String?
}

model UserClaim {
    id        String  @id @default(auto()) @map("_id") @db.ObjectId
    userId    String  @db.ObjectId
    user      User    @relation(fields: [userId], references: [id])
    claimType String
    value     String?
}

model Post {
    id        String  @id @default(auto()) @map("_id") @db.ObjectId
    authorId  String? @db.ObjectId
    content   String?
    published Boolean @default(false)
    title     String
}

model Image {
    id         String   @id @default(auto()) @map("_id") @db.ObjectId
    url        String
    createDate DateTime @default(now())
    info       Info[]
    infoIDs    String[] @db.ObjectId
    infos      Info[]   @relation(name: "infos", fields: [infoIDs], references: [id])
}

model Info {
    id          String   @id @default(auto()) @map("_id") @db.ObjectId
    tiles       String   @default("")
    summary     String   @default("")
    description String   @default("")
    thumbnailId String   @db.ObjectId
    thumbnail   Image?   @relation(fields: [thumbnailId], references: [id])
    bannerIds   String[] @db.ObjectId
    banners     Image[]  @relation(name: "infos", fields: [bannerIds], references: [id])

    @@map(name: "info")
}
